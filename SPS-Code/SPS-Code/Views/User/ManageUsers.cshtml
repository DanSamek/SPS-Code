@using SPS_Code.Data.Models;
@model List<UserModel>
@{
    List<UserCategory> cats = ViewBag.Categories;
}

@section Style {
    <link rel="stylesheet" href="~/css/ManageUsers.css" asp-append-version="true" />
}

<div class="user-overview">
    <div>
        <div>
            <p>E-mail</p>
            <p>Jméno</p>
            <p>Přijmení</p>
            <p>Kategorie</p>
            <p></p>
        </div>
        <p>Změna hesla</p>
        <p>Smazat</p>
    </div>
    @{ int index = 0; }
    @foreach (var user in Model)
    {
    <div>
        <form action="/user/edit/@user.Id" method="post">
            <input type="text" value="@user.Email" name="Email" >
            <input type="text" value="@user.FirstName" name="FirstName" >
            <input type="text" value="@user.LastName" name="LastName">
            <select name="CategoryID">
                @foreach(var cat in cats)
                {
                    if (user.UserCategory.ID == cat.ID)
                    {
                        <option selected value="@cat.ID">@cat.Name</option>
                    }
                    else
                    {
                        <option value="@cat.ID">@cat.Name</option>
                    }
                }
            </select>
            <input type="submit" value="Odeslat">
        </form>
        <button onclick="document.getElementsByClassName('chpasswd')[@index].style.display = 'grid'">Změnit Heslo</button>
        <form action="/user/chpasswd/@user.Id" method="post" class="chpasswd">
            <h2>Změna hesla</h2>
            <input type="password" name="NewPassword" placeholder="Nové heslo...">
            <input type="password" name="NewPasswordCheck" placeholder="Nové heslo kontrolní...">
            <input type="submit" value="Odeslat">
            <div onclick="document.getElementsByClassName('chpasswd')[@index].style.display = ''">×</div>
        </form>
            <a href="/user/delete/@user.Id" onclick="return confirm('Opravdu si přejete smazat uživatele @(user.FirstName+" "+user.LastName)?')" class="delete"><img src="~/img/bin.png" /><img src="~/img/bin-open.png" /></a>
    </div>
    index++;
    }
</div>